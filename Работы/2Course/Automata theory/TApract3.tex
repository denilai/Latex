\documentclass[a4paper,14pt]{extarticle}

% Путь до папки с общими шаблонами
\newcommand{\pathToCommonFolder}{/home/denilai/Desktop/LaTeX/Common}
% Название работы в титуле
\newcommand{\workname}{Отчет по практической работе №3}
% Название дисциплины в титуле
\newcommand{\discipline}{Теория автоматов}
% Название кафедры в титуле
\newcommand{\kafedra}{Кафедра Вычислительной техники}
% Тема работы в титуле
\newcommand{\theme}{Делитель 4-разрядных чисел без знака}
% Должность преподавателя в титуле
\newcommand{\rang}{ассистент}
% ФИО преподавателя в титуле
\newcommand{\teacherfio}{А.~С.~Боронников}


\usepackage{tabularx}

\usepackage{booktabs}
\newcolumntype{b}{X}
\newcolumntype{s}{>{\hsize=.5\hsize}X}
\newcommand{\heading}[1]{\multicolumn{1}{c}{#1}}

% Вставка заготовки преамбулы
\input{\pathToCommonFolder/ruspreamble}

% установка размера шрифта для всего документа
%\fontsize{20pt}{18pt}\selectfont
\usepackage{extsizes} % Возможность сделать 14-й шрифт

\author{Кирилл Денисов}
\title{Практическая работа №3}
\date{\today}

% установка полуторного интервала
% \usepackage{setspace}  
% \onehalfspacing

% использовать Times New Roman
\renewcommand{\rmdefault}{ftm}


\begin{document}
	\thispagestyle{empty}
	
	% Вставка первого титульного листа
	\input{\pathToCommonFolder/titul}
	
	\newpage
	\tableofcontents
	\newpage
	
\section{Общее строение автомата}
В любом устройстве обработки цифровой информации можно выделить два основных блока – операционный автомат (ОА) и управляющий автомат (УА). Операционный автомат (ОА) служит для хранения слов информации, выполнения набора микроопераций и вычисления значений логических условий, т.е. операционный автомат является структурой, организованной для выполнения действий над информацией. Микрооперации, выполняемые ОА, задаются множеством \textit{управляющих} сигналов $Y\left\{y_1,....,y_M\right\}$, с каждым из которых отождествляется определенная микрооперация.

Значения логических условий, вычисляемые в операционном автомате, отображаются множеством \textit{осведомительных} сигналов $X=\left\{x_1,...,x_L\right\}$, каждый из которых отождествляется с определенным логическим условием.

Управляющий автомат (УА) генерирует последовательность управляющих сигналов, предписанную микропрограммой и соответствующую значениям логическим условий. Управляющий автомат задает порядок выполнения действий в ОА, вытекающий из алгоритма выполнения операций. Наименование операции, которую необходимо выполнить в устройстве, определяется кодом g операции, поступающим в УА извне. 

В отличие от УА с жесткой логикой, закон функционирования которого обеспечивается определенным образом соединенными логическими элементами, в автоматах, построенных на основе ПЗУ, заданная микропрограмма реализуется в явной форме и хранится в памяти в виде последовательности управляющих слов. Управляющее слово определяет порядок работы устройства в течение одного такта и называется микрокомандой (МК). Она содержит информацию о микрооперациях, которые должны выполняться в данном такте, и (или) об адресе следующей микрокоманды.
\section{Индивидуальное задание}
В ходе данной практической работы был реализован автомат, выполняющий деление 4-разрядных чисел без знака (алгоритм без восстановления остатка). Управляющий автомат был построен по схеме с одним адресом в памяти в последовательном варианте. Рассмотрим строение управляющего автомата. См рисунок~\ref{img:scheme}.

\begin{figure}[h!]
	\begin{center}
		\includegraphics[width=0.5\linewidth]{one_adress_rom}
		\caption{УА с одним адресом в памяти; последовательный вариант}
		\label{img:scheme}
	\end{center}	
\end{figure}

В конкретной реализации на информационные входы мультиплексора подаются сигналы \textit{e} -- сигнал с ПЗУ, \textit{B\_IS\_NULL} -- признак нулевого делителя, \textit{CT\_IS\_NULL} -- признак окончания счета, \textit{b\_high} -- значение старшего бита частичного остатка на текущей итерации, а на адресный вход подается двухбитовый сигнал \textit{H}.
\section{Алгоритм работы автомата}
Опишем алгоритм работы автомата с помощью блок схемы. Используем сумматор для нахождения текущего значение частичного остатка (ЧО), счетчик для подсчета обработанных разрядов и регистры для хранения и использования разрядов делителя и делимого. Обозначим микрокоманды от $m_0$ до $m_4$. См. рисунок~\ref{img:algorithm} в \hyperref[tam]{Приложении~А}.

После построения алгоритма работы автомата следует перейти к реализации операционной части.

\section {Реализация Операционного автомата}
Построим операционный автомат, выполняющий деление двух 4-разрядных чисел посредством использования четырех регистров, в том числе трех сдвиговых. Приведем названия и назначения каждого из регистров. См. таблицу \ref{tab:regs}.
\begin{table}[h!]
	\centering
		\begin{tabular}{|m{0.27\linewidth}|m{0.6\linewidth}|}
			\hline
			\textbf{Идентификатор} & \textbf{Назначение} \\ \hline
			$RG\_A$ & Сдвиговый регистр. Хранит разряды делимого \\ \hline
			$RG\_B$ & Хранит разряды делителя \\ \hline
			$RG\_REM$ & Сдвиговый регистр. Хранит разряды частичного остатка \\ \hline
			$RG\_RES$ & Сдвиговый регистр. Хранит разряды результата \\ \hline
		\end{tabular}
		\caption{Регистры операционного автомата}
		\label{tab:regs}
\end{table}

Укажем необходимые признаки, которые впоследствии будут вырабатываться управляющим автоматом. См. таблицу \ref{tab:signals}.
\begin{table}[h!]
	\centering
	\begin{tabular}{|m{0.27\linewidth}|m{0.6\linewidth}|}
		\hline
		\textbf{Признак} & \textbf{Назначение} \\ \hline
		$S$ & Хранит адрес следующей операции \\ \hline
		$Н$ & Адресный вход мультиплексора \\ \hline
		$R0$ & Сигнализирует об окончании операции деления \\ \hline
		$ERROR$ & Сигнализирует об ошибке ввода -- делитель равен нулю \\ \hline
		$L\_RG_A$ & Загрузка в регистр $RG\_A$ \\ \hline
		$L\_RG_B$ & Загрузка в регистр $RG\_B$ \\ \hline
		$L\_RG_REM$ & Загрузка в регистр $RG\_REM$ \\ \hline
		$CLR$ & Асинхронный сброс всех элементов \\ \hline
		$COUNT\_CT$ & Счет. Декремент счетчика, если $L\_CT==1$ \\ \hline
		$L\_CT$ & Загрузка счетчика \\ \hline
		$SHIFT$ & Левый сдвиг в регистрах $RG\_A \text{ и } RG\_RES$ \\ \hline
	\end{tabular}
	\caption{Осведомительные сигналы (признаки)}
	\label{tab:signals}
\end{table}
 С целью реализации левого сдвига в сдвиговых регистрах разряды делимого и текущего значения частичного остатка загружаются в регистры в обратном порядке. Это позволяет отказаться от универсального сдвигового регистра, так как реализации данного алгоритма необходим только левый сдвиг, и как следствие, упрощает схему. 

Для исключения возникновения ошибки при левом сдвиге разрядов частичного остатка в случае, когда два его старших разряда различны, использованы 6-разрядные регистры. См. сноску \ref{sign}.

Соединим все элементы в соответствии с алгоритмом задачи. См. рисунок \ref{img:oa} в приложении \hyperref[tam]{Приложении А}.
\begin{equation}
	\begin{aligned}
	\label{sign}
	-|B| &\neq 10X...X \\
	-|B| &= 110X...X
	\end{aligned}
\end{equation}
\section {Реализация управляющего автомата}
Приступим к построению управляющего автомата, определяющего последовательность выполнения микрокоманд для деления двух 4-разрядных чисел без знака.

Определим разрядность ПЗУ, участвующего в построении УА по схеме с одним адресом в памяти. Адрес должен иметь 4 разряда, где 3 старших разряда~--- текущее значение параметра \textit{S}, а младший разряд~--- значение $q$, генерируемое мультиплексором. Микрокоманда представлена в виде 15 бит~--- 12 признаков, расположенных в следующем порядке:\hspace{0ex}$S, H, R0, ERROR, CLR,$ $L\_CT,$ $COUNT\_CT,$ $SHIFT,$ $L\_RG\_REM, L\_RG_B, L\_RG_A, e$. Адрес текущей команды будет храниться в 4-разрядном регистре.


Заполним память в соответствии в алгоритмом, подключим ПЗУ и регистр последовательным способом. См рисунок \ref{img:ma}.
\begin{figure}[h!]
	\centering
	\includegraphics[width=\linewidth]{MA3}
	\caption {Схема операционного автомата}
	\label{img:ma}
\end{figure}

\section{Тестирование работы автомата}
После реализации операционного и управляющего автомата следует приступить к объединению данных устройств, тестированию их совместной работы. Подключим признаки к входам соответствующих логических элементов и цифровых устройств с помощью туннелей. Добавим блок ввода исходных данных, используя контакты, блок вывода~---регистр результата операции деления и регистр остатка, индикатор завершения операции деления.

Проведем проверку корректности выходных результатов построенного цифрового устройства. Разделим два наибольших 4-разрядных двоичных числа $1111_2 \div 1111_2$ ожидая получить частное $1_2$ и остаток $0_2$ . Укажем входные данные, будем подавать тактовые сигналы до тех пор, пока индикатор не сообщит нам о завершении операции, сравним практические результаты с ожидаемыми. См рисунок~\ref{img:test}. Умножение выполнено корректно. Ожидаемые и полученные результаты совпадают.
\begin{figure}[h!]
	\centering
	\includegraphics[width=0.6\linewidth]{test3.1}
	\caption {Проверка работы автомата}
	\label{img:test}
\end{figure}

Протестируем работу автомата на входных данных, которые гипотетически могут привести к ошибке --- поделим число $101_2$ на число $1111_2$. Ошибка состоит в том, что в случае использования регистров недостаточной разрядности, левый сдвиг при вычислении очередного остатка произойдет некорректно, что приведет к неверному результату. Введем данные, пронаблюдаем за работой автомата. См рисунок \ref{img:test2}. Операция выполнена верно. Использование регистров большей разрядности исключило возможность ошибки.
\begin{figure}[h!]
	\centering
	\includegraphics[width=0.6\linewidth]{test3.2}
	\caption {Вторая проверка работы автомата}
	\label{img:test2}
\end{figure}
\section {Вывод}
В ходе данной практической работы было рассмотрено строение и работа управляющего автомата, построенного по схеме с одним адресом в памяти. Использовав полученные знания на практике, на основе данного управляющего автомата построено вычислительное устройство (операционный и управляющий автомат), реализующее операцию деления двух 4-разрядных чисел без знака.

Работа данного устройства испытана, проверена корректность полученных результатов при работе со всеми категориями входных данных. 

\newpage{
\centering
\anonsection{ПРИЛОЖЕНИЕ А}
}
\label{tam}
\begin{figure}[h!]
	\centering
	\includegraphics[width=0.7\linewidth]{algorithm3}
	\caption {Алгоритм деления двух 4-разрядных чисел}
	\label{img:algorithm}
\end{figure}
\newpage
\begin{figure}[h!]
	\centering
	\includegraphics[width=\linewidth]{OA3}
	\caption {Схема операционного автомата}
	\label{img:oa}
\end{figure}

\end{document}


