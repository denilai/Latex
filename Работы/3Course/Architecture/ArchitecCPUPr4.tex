\documentclass[a4paper,14pt]{extarticle}

% Путь до папки с общими шаблонами
\newcommand{\pathToCommonFolder}{/home/denilai/Documents/repos/latex/Common}
% Название работы в титуле
\newcommand{\workname}{Отчет по практической работе №4}
% Название дисциплины в титуле
\newcommand{\discipline}{Архитектура процессоров и микропроцессоров}
% Название кафедры в титуле
\newcommand{\kafedra}{Кафедра вычислительной техники}
% Тема работы в титуле
\newcommand{\theme}{Стадии выполнения команд процессором КР580ВМ80}
% Должность преподавателя в титуле
\newcommand{\rang}{cтарший преподаватель кафедры ВТ}
% ФИО преподавателя в титуле
\newcommand{\teacherfio}{Ю.~М.Скрябин}
\newcommand{\studentfio}{К.~Ю.~Денисов}

\usepackage{tabularx}



\usepackage{booktabs}
\newcolumntype{b}{X}
\newcolumntype{s}{>{\hsize=.5\hsize}X}
\newcommand{\heading}[1]{\multicolumn{1}{c}{#1}}

% установка размера шрифта для всего документа
%\fontsize{20pt}{18pt}\selectfont
\usepackage{extsizes} % Возможность сделать 14-й шрифт

% Вставка заготовки преамбулы
\input{\pathToCommonFolder/ruspreamble}

\author{Кирилл Денисов}
\title{Лабораторная работа №1}
\date{\today}

\renewcommand{\withouttheme}{1}

% установка полуторного интервала
% \usepackage{setspace}  
% \onehalfspacing

% использовать Times New Roman
\renewcommand{\rmdefault}{ftm}


\begin{document}
	\thispagestyle{empty}
	% Вставка первого титульного листа
	\input{\pathToCommonFolder/titul-with-signature}
	\newpage
	%\tableofcontents
	\newpage
	%\listoftables

	
	\section{Цель работы}
	Для заданного в таблице 4 закодированного графа разработать три микропрограммных автомата (МПА):
	\begin{enumerate}
		\item МПА Мили на жесткой логике;
		\item Управляющий автомат на программируемой
		логике (УАПЛ) с принудительной адресацией с 2-я адресными полями;
		\item УАПЛ с естественной адресацией. 
	\end{enumerate}
	Для УАПЛ выбрать смешанный способ микропрограммирования.
	
	
\section {Индивидуальный вариант № 9}
	
	\subsection{Перечень сокращений}
	Приведем также перечень сокращений, используемых в ходе данной работы:
	
	МКП --- микропрограмма
	
	МПА --- микропрограммный автомат
	
	ГСА --- граф-схема автомата
	
	АЛУ --- арифметико-логическое устройство
	
	УУ --- устройство управления
	
	КС1 --- первая комбинационная схема 
	
	КС2 --- вторая комбинационная схема 
	
	ОП --- операционное поле
	
	АП --- адресное поле 
	
	БП --- безусловный переход
	
	УП --- условный переход
	
	
	%ША --- шина адреса
	
	%ШД --- шина данных
	
	%ШУ --- шина управления
	
	СЧАМК --- счетчик адреса микрокоманд
	
	ОЗУ  --- оперативное запоминающее устройство
	
	%	$РА_{ОЗУ}$ --- регистр адреса оперативного запоминающего устройства
	
	%	$РД_{ОЗУ}$ --- регистр данных оперативного запоминающего устройства
	
	%	$ШД_{ОЗУ}$ --- шина адреса оперативного запоминающего устройства
	
	РК  --- регистр команд
	
	
	DC  --- дешифратор
	
	SM -- сумматор
	
	КОП --- код операции
	
	РА1, РА2 --- входные регистры АЛУ
	
	РС1, РС2 --- входные регистры сумматора
	
	$РР_{АЛУ}$ --- регистр результата АЛУ
	
	РОН --- регистр общего назначения
	
	ЧТРОН --- управляющий сигнал на чтение РОН
	
	$РД_{РОН}$  --- регистр данных регистров общего назначения
	
	$РА_{РОН}$  --- регистр адреса регистров общего назначения
	
	УС --- указатель стека
	


	В ходе данной лабораторной работы нам было предложено разработать три микропрограммных автомата (МПА). Приведем абстрактный граф-схему автомата (ГСА) (см. Рисунок \ref{fig:gsa}). Где  $a_1 ... a_5$ --- состояния автомата, причем $a'_1$~---~конечное состояние автомата.
	% TODO: \usepackage{graphicx} required
	\begin{figure}[htpb]
		\centering
		\includegraphics[width=0.5\linewidth]{images/gsa}
		\caption{Граф-схема автомата}
		\label{fig:gsa}
	\end{figure}
	
	Получим закодированный граф на базе ФСА, заменив микрооперации
	управляющими сигналами \{y\}, а логические условия~---~осведомительными сигналами~\{x\}.
	
	Рассмотрим реализацию блока управления на базе МПА с жесткой логикой (автомат Мили), приведенного на Рисунке \ref{fig:mili}.
	
	% TODO: \usepackage{graphicx} required
	\begin{figure}[h!]
		\centering
		\includegraphics[width=0.8\linewidth]{images/mili}
		\caption{МПА на жесткой логике на базе автомата Мили }
		\label{fig:mili}
	\end{figure}
%\newpage
В состав \ref{fig:mili} МПА входят следующие структурные элементы: 
\begin{itemize}
	\item 2-х ступенчатая память автомата;
	\item дешифратор состояния (ДСсост.);
	\item две комбинационные схемы КС1 и КС2. 
\end{itemize}
Память служит для запоминания состояния автомата.

Во второй ступени фиксируется текущее состояние, по которому комбинационная
схема КС1 формирует набор управляющих сигналов. Первая ступень предназначена
для формирования следующего состояния в зависимости от предыдущего и
значений осведомительных сигналов. Переключение первой ступени памяти осуществляет схема КС1.

Двухступенчатая память применяется для исключения
<<гонок>> из-за разницы в величине задержек в КС1 при переключении различных разрядов памяти.

Для ГСА (Рисунок \ref{fig:gsa}) выходы операторных вершин, отмеченные символами $a_1 ... a_5$ соответствуют состояниям памяти МПА. Присвоим состояниям двоичные коды:
\begin{align*}
 	а1(a1') &= 000 \\
 	а2 &= 001 \\ 
 	а3 &= 010 \\
 	 а4 &= 011 \\
 	 а5 &= 100
\end{align*}


Для кодирования пяти состояний потребовалось три двоичных разряда, 
соответственно память автомата будет строиться на трех триггерах.
Выход вершины <<начало>> и вход в вершину <<конец>> отмечен одним и
тем же символом а1. Это соответствует одному и тому же состоянию памяти и
означает, что после выполнение своих функций по генерации \{y\} в соответствии заданной ГСА, МПА возвращается в исходное положение до следующей
инициализации. Для этого в ГСА после вершины <<Начало>> необходимо поставить ждущую вершину:

% TODO: \usepackage{graphicx} required
\begin{figure}[htbp]
	\centering
	\includegraphics[width=0.3\linewidth]{images/delay-node}
	\caption{Ждущая вершина}
	\label{fig:delay-node}
\end{figure}

Начало работы автомата обеспечивает сигнал <<В>>, устанавливаемый
извне в «1» (интерпретируется как осведомительный сигнал). После этого
он сбрасывается в «0», а МПА после завершения работы снова переходит
в состояние покоя <<а1>>.
Для реализации МПА необходимо по ГСА построить таблицу состояний
и переходов автомата (Рисунок \ref{fig:state-table}). 
%\newpage
% TODO: \usepackage{graphicx} required
\begin{figure}
	\centering
	\includegraphics[width=\linewidth]{images/state-table}
	\caption{Таблица состояний}
	\label{fig:state-table}
\end{figure}

В таблице отмечаются состояния МПА, управляющие сигналы, формируемые в каждом состоянии при наличии определенных значений осведомительных сигналов. Кроме того, в правой колонке таблицы записываются сигналы возбуждения памяти, формируемые по кодам состояния текущего и следующего состояния памяти.

 Значения сигналов определяются таблицами переключения триггеров, выбранных для построения памяти. В данном случае память реализована на RS-триггерах.
Таблица позволяет описать логическую организацию схем КС1 и КС2,
т.е. произвести их абстрактный синтез.

\underline{Для КС1}
\begin{align*}
	y_1 &= a_2 B+a_5x_1 \\
	y_2 & =a_3 + a_2x_3 \\
	y_3 & = a_2B + a_1x_2 \\
	y_4 &=a_3+a_2x_3 \\
	y_5 & =a_5x_1+a_1x_2 \\
	y_6 & = a_5x_1+a_4\bar{x_1}
\end{align*}

%\newpage
\underline{Для КС2}
\begin{align*}
	S_1 &=a_2B+a_4\bar{x_1}+a_2x_3 & R_1 & = a_3+a_5x_1+a5\bar{x_3} + a_1\bar{x_2}\\
	S_2 & =a_3 &  	R_2 & = a_5+ a_4+a_2+a_1\\
	S_3 & = a_5x_1 + a_5\bar{x_3} & R_3 & = a_4\bar{x_1}+ a_2x_3+ a_1\\
\end{align*}
	
	По полученным логическим выражениям произведем структурный синтез схем КС1 и КС2 и построим электрическую функциональную схему МПА.
	
	\paragraph{Реализация блока управления на базе МПА с программируемой логикой.}
	В МПА с программируемой логикой ГСА реализуется посредством микропрограммы (МКП), хранимой в управляющей памяти. Микропрограмма состоит из микрокоманд (МК), последовательность которых описывает графсхему алгоритма управления. Микрокоманда представляет собой машинное
	слово, состоящее из двух полей (Рисунок \ref{fig:op}). 
	
	% TODO: \usepackage{graphicx} required
	\begin{figure}[h!]
		\centering
		\includegraphics[width=0.3\linewidth]{images/op}
		\caption{Машинное слово МПА	}
		\label{fig:op}
	\end{figure}

В ОП микрокоманды записываются управляющие сигналы или их коды. В АП~---~коды номеров условных вершин
ГСА и адрес или адреса перехода к следующей микрокоманде.

Организуем ОП смешанным горизонтально-вертикальным способом. В нашем случае ОП будет состоять из трех сегментов $NY1 – NY3$, по которым распределяются управляющие сигналы (см. Таблицу \ref{tab:op-mix}).

\begin{table}[h!]
	\centering
		\begin{tabular}{|c|c|c|c|c|c|}
		\hline
		\multicolumn{2}{|c|}{NY1} &  \multicolumn{2}{c|}{NY2} & \multicolumn{2}{c|}{NY3}  \\
		\hline
		\textbf{01} & y1 & \textbf{01} & y5 & \textbf{01} & y6 \\
		\hline
		\textbf{10} & y4 & \textbf{10} & y2 & \textbf{10} & y3 \\
		\hline
		\textbf{11} & yk & \textbf{} &  & \textbf{} &  \\
		\hline
		\textbf{00} & отс. & \textbf{00} & отс. & \textbf{00} & отс. \\
		\hline
	\end{tabular}
	\caption{Организация ОП смешанным способом}
	\label{tab:op-mix}
\end{table}


Способы перехода в микропрограммах к следующей микрокоманде определяются форматами адресных полей МК и правилами перехода. Принудительный переход выполняется по адресу, указанному в самой МК. Это соответствует безусловному переходу команд БП. При естественной адресации микрокоманд следующая микрокоманда адресуется посредством инкремента счетчика адреса микрокоманд (СЧАМК).

\paragraph{Микропрограммный автомат с принудительной адресацией МК}
Форматы МК с двумя адресными полями при принудительной адресации
могут иметь следующий вид (Рисунок \ref{fig:mk-mix}.

% TODO: \usepackage{graphicx} required
\begin{figure}[h!]
	\centering
	\includegraphics[width=0.5\linewidth]{images/mk-mix}
	\caption{Форматы микрокоманд}
	\label{fig:mk-mix}
\end{figure}

В Таблице \ref{tab:manage-algorithm} представлена МКП, описывающая рассматриваемый алгоритм управления


\begin{table}[htbp]
	\centering

	\begin{tabular}{|c|c|c|c|c|c|c|c|}
		\hline
		Разряды & 0:1 & 2:3 & 4:5 & 6:7 & 8:10 & 11:13 & Вид \\ \hline
		Адрес в УП & NY1 & NY2 & NY3 & NX & $A_0$ & $A_1$ & УП \\ \hline \hline
		1 & <y1> & - & <y3> & 00 & 2 & - & БУ \\ \hline
		2 & <y4> & <y2> & - & NX1 & 3 & 4 & УП \\ \hline
		3 & - & - & <y6> & NX3 & 5 & 2 & УП \\ \hline
		4 & <y1> & <y5> & <y6> & NX2 & 7 & 6 & УП \\ \hline
		5 & - & - & - & NX2 & 7 & 6 & УП \\ \hline
		6 & - & <y5> & <y3> & 00 & 7 & - & БУ \\ \hline
		7 & <yк> & - & - & - & - & - &  \\ \hline
	\end{tabular}
	\caption{Алгоритм управления}
	\label{tab:manage-algorithm}
\end{table}

\paragraph{Микропрограммный автомат с естественной адресацией}
Рассмотрим вариант, предлагающий наличие двух типов микрокоманд: операционной, которая выполняет полезную работу и обрабатывает операторные
вершины ГСА, и управляющей МК условного и безусловного переходов (рис. 9).


	
	
	\section{Порядок выполнения работы}
	
	
	
	
	\subsection{ФСА цикла исполнения команд}
	

	
	\anonsection{Вывод}
	В ходе данной практической работы мы ознакомились со структурной схемой ядра ЭВМ, изучили с процесс выполнения ЭВМ арифметических операций, изучили режим адресации с базированием и индексированием, научились строить функциональную схему алгоритма цикла исполнения команд. Полученные знания применили на практике.
	
	
\end{document}

